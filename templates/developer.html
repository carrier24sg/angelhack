<!DOCTYPE html>
<html lang="en">
<head>
  <title>Developer Page</title>
  <link rel="stylesheet" href="../main/static/css/bootstrap.min.css">
  <link rel="stylesheet" href="../main/static/css/jquery-ui.min.css">
  <link rel="stylesheet" href="../main/static/css/utility.css">
  <link rel="stylesheet" href="../main/static/css/developer.css">

  <script src="../main/static/js/jquery.js"></script>
  <script src="../main/static/js/jquery-ui.min.js"></script>
  <script src="../main/static/js/underscore.js"></script>
  <script src="../main/static/js/backbone.js"></script>  
  <script src="../main/static/js/helper.js"></script>
  <script src="../main/static/js/accounting.js"></script>
</head>
<body>
  <div class="container" id="wrapper">
    
    <div id="header"></div>

    <div class="row">
      <div class='span6'></div>
      <div class='span6'>
        <h2>Recent comments</h2>
        <ul id='commentsContainer'></ul>
      </div>
    </div> 
  </div>

  <script type="text/template" id="developer-template">
    <h2><%= capitalizeWords(model.name) %></h2>
    <img src= <%= model.src %> />
    <p> Score: <%= model.scoreGivenByCompany %></p>
    <ul class="comments"></ul>
  </script>
  
  <script type="text/template" id="comment-template">
    
    <p> <%= capitalizeWords(app.companyRepresentativesList[model.givenBy]) %> 
    <%= model.points > 0 ? "gave" : "took away" %> 
    <%= Math.abs(model.points) %> 
    <%= model.points > 1 ? "points" : "point" %> 
    for <%= model.category %> </p>
    <div class="commentWrapper">  
      <p> <%= model.text %>
    </div>
  </script>  

  <script type="text/template" id="header-template">
    <h2>Task Description</h2>
    <p><%= model.task %> </p>
    <h2>Position</h2>
    <p><%= model.position %></h2>
  </script>  

  <script src="../main/static/js/data.js"></script>
  <script src="../main/static/js/initialize.js"></script>
  <script src="../main/static/js/models/developer.js"></script>
  <script src="../main/static/js/models/comment.js"></script>
  <script src="../main/static/js/models/company.js"></script>

  <script src="../main/static/js/collections/developers.js"></script>
  <script src="../main/static/js/collections/comments.js"></script>
  
  <script src="../main/static/js/views/appdeveloper.js"></script>
  <script src="../main/static/js/views/company.js"></script>
  <script src="../main/static/js/views/developers.js"></script>
  <script src="../main/static/js/views/comments.js"></script>
  <script>
    $(function() {
      var developer, idToBeSearched = 1;
      
      //searches for json data of developer clicked
      for( var i = 0; i < developersData.length; i++) {
        if(developersData[i].id === idToBeSearched) {
          developer = developersData[i];
          break;
        }
      }

      if(typeof developer === 'undefined') {
        alert('Error');
      }
      
      app.comments = new app.Comments(commentsData);
      app.developer = new app.Developer(developer);
      new app.MainDeveloperView();
      app.commentsView = new app.CommentsView({collection: app.comments, 
        $el: $('#commentsContainer'), givenTo: idToBeSearched});
      
      $('#dialog-form').dialog({
        autoOpen: true,
        height: 500,
        width: 500,
        modal: true,
        buttons: [{
          text: "Submit Comment",
          click: function() {
            //sending comment 
            app.comments.create({
              givenBy: 1,
              giventTo: 2,
              points: $(this).find('#points').val(),
              category: $(this).find('#category').val(),
              text: $(this).find('#text').val()
            })

            $(this).dialog('close');
          }
        }]
      })

    });
  </script>

  <div id="dialog-form" title="Create New Comment!">
    <form>
      <fieldset>
        <select id="category" class="span2">
          <option disabled>Category:</option>
          <option value="attitude">Attitude</option> 
          <option value="codequality">Code Quality</option> 
          <option value="communication">Communications</option> 
          <option value="others">Others</option> 
        </select>

        <select id="points" class="span2">
          <option disabled>Points:</option>
          <option value=3>3</option> 
          <option value=2>2</option> 
          <option value=1>1</option> 
          <option value=-1>-1</option> 
          <option value=-2>-2</option> 
          <option value=-3>-3</option> 
        </select>
        <br>
        <textarea class='span4' rows=5 placeholder='Enter comments here...' id='text'></textarea>        
      </fieldset>
    </form>
  </div>   

  
</body>
</html>